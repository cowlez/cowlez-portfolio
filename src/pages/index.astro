---
import Layout from '@layouts/Default.astro';

import { MusicCard } from '@components/MusicCard';
import { IconName } from '@fortawesome/fontawesome-svg-core'
import { FontAwesomeIcon } from '@fortawesome/react-fontawesome'
import { Weather } from 'components/Weather'
import Time from '@components/Time';
import VSCodeCard from '@components/VSCodeCard';
import PlexCard from '@components/PlexCard';
import ProjectCard from '@components/ProjectCard.astro';
import SkillCard from '@components/SkillCard.astro';
import SocialIcon from '@components/SocialIcon.astro';

import { Icon } from 'astro-icon'
---
<script>
  const select = document.getElementById("themeSwitch") as HTMLSelectElement;
  const theme = localStorage.getItem("theme");
  const systemTheme = window.matchMedia("(prefers-color-scheme: dark)").matches
    ? "dark"
    : "light";

  if (theme !== null) {
    select.value = theme;
  } else {
    select.value = systemTheme;
  }

  function updateTheme(value) {
    const theme = value === "system" ? systemTheme : value;
    document.documentElement.classList.remove("light", "dark");
    document.documentElement.classList.add(theme);
    localStorage.setItem("theme", value);
  }

  updateTheme(select.value);

  select.addEventListener("change", (event: Event) => {
    const select = event.target as HTMLSelectElement;
    updateTheme(select.value);
  });
</script>
<script>
	// Weather
	const res = await fetch(`https://api.openweathermap.org/data/2.5/weather?q=Cordignano&units=imperial&appid=eecd2e62383a31c75535e0c23d2eb967&lang=en`);
	const data = await res.json();
	const temp_f = data.main.temp;

	const res2 = await fetch(`https://api.openweathermap.org/data/2.5/weather?q=Cordignano&units=metric&appid=eecd2e62383a31c75535e0c23d2eb967&lang=en`);
	const data2 = await res2.json();
	const temp_c = data2.main.temp;

	const weather_element = document.getElementById(`weather`);
	if (weather_element) {
		weather_element.innerHTML = weather_element.innerHTML = `${Math.round(temp_c)}°C`;

		weather_element.addEventListener('mouseover', () => {
			weather_element.innerHTML = `${Math.round(temp_f)}°F`;
		});

		weather_element.addEventListener('mouseout', () => {
			weather_element.innerHTML = `${Math.round(temp_c)}°C`;
		});
	}
</script>
<Layout>
	<h1 class="mb-1">I'm <span class="bg-gradient-to-r from-blue-600 to-[#ff6c7b] dark:from-blue-300 dark:to-[#ffacb4] animate-[gradient_3s_ease-in-out_infinite] clip">cowlez</span>!</h1>
	<h3 class="font-normal mb-2"><span id="weather" class="font-medium">Loading weather</span> in Vittorio Veneto, Veneto, Italy</h3>
	<h4 class="font-normal mb-4"><Icon name="mdi:clock" class="fill-neutral-900 dark:fill-white h-5 inline" /> <Time client:only="react" /></h4>
	<div class="grid grid-flow-col w-48 mt-3 text-lg mb-5">
		<SocialIcon name="Instagram" href="https://instagram.com/leooolllll" icon="mdi:instagram" />
		<SocialIcon name="PayPal" href="https://paypal.me/MrCowLess" icon="mdi:paypal" />
		<SocialIcon name="Discord" href="https://discord.com/users/1190035192816083076" icon="ic:baseline-discord" />
		<SocialIcon name="Email" href="mailto:leo@cowlez.eu" icon="mdi:email" />
	</div>

	<div class="grid grid-cols-1 md:grid-cols-4 gap-6">
		<MusicCard client:only="react" />
	</div>
</Layout>
